INIT	
	BANK1
	BSF TRISC,3
	BSF TRISC,4
	CLRF SSPSTAT 
	BSF SSPSTAT,SMP
	MOVLW 0x18
	MOVWF SSPADD
	CLRF SSPCON2
	BANK0
	MOVLW B'00101000' 
	MOVWF SSPCON
 	BCF PIR1,SSPIF
	BCF PIR2,BCLIF 
	RETLW 0 
 
BSTART
	BANK0
	BCF PIR1,SSPIF
	BANK1
	SSPCON2,SEN
	BANK0

bstart_wait
	BTFSS PIR1,SSPIF
	GOTO bstart_wait
	RETLW 0

BRESTART
	BANK0
	BCF PIR1,SSPIF
	BANK1
	SSPCON2,RSEN
	BANK0
brestart_wait
	BTFSS PIR1,SSPIF
	GOTO brestart_wait
	RETLW 0

BSTOP
	BANK0
	BCF PIR1,SSPIF
	BANK1
	SSPCON2,PEN
	BANK0
bstop_wait
	BTFSS PIR1,SSPIF
	GOTO bstop_wait
	RETLW 0

TX
	BANK0
	BCF PIR1,SSPIF
	MOVF datao,W
	MOVWF SSPBUF
tx_wait
	BTFSS PIR1,SSPIF
	GOTO tx_wait
	BANK1
	BTFSC SSPCON2,ACKSTAT
	GOTO ackfailed
	RETLW 0
ackfailed
	RETLW 0